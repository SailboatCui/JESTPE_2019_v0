\section{Introduction}\label{sec:Intro}
Although peak (or valley) current mode control (PCC) has been widely used in DC-DC voltage regulator control for a long time, high frequency \footnote{switching frequency $> 1$ MHz} dc-dc converters using PCC are seldom reported in the literature.

Parasitic ringing is an important bottleneck when implementing PCC. The severe voltage spikes is common in a high frequency power converts using PCC as shown in. In one of our experiments, when these harsh parasitic ringings contaminate current measurements, the inner current loop of a current-mode buck converters using constant on-time (CM-COT) buck converter can actually be unstable. This phenomena challenges the traditional understanding that in CM-COT buck converters, the {\color{red} inner current loop / current command block} is deadbeat and stable at all operating points \cite{Redl1981}. In this paper, we provide new theoretical criteria which explain why and predict when this instability phenomena happen.
% We also prove that the stability margin can be improved by slowing down the controller bandwidth.

It is impossible to decrease the parasitic inductance under the level of $n$H under the constraints of the current pc board technology. Therefore, we solve this problem in another way: instead of eliminating parasitic ringings, we show three new compensation techniques which guarantee the PCC to work in harsh parasitic ringing conditions - analog comparator overdrive propagation delay {\color{red}(COPD)}, low-pass filter and slope compensation. We show that the overdrive propagation delay of the analog comparator can be eliminate the effect of parasitic ringing interference on the plant. We explain that the slope compensation, which is widely used in fixed-frequency PCC, can also be used in variable-frequency PCC to reject the parasitic ringing interference. We claim that a low-pass filter with cut-off frequency slower than switching frequency can still result in a good performance.
Furthermore, unlike the traditional compensation design methods based on rule-of-thumbs and design experiences, we show a rigorous analysis tool to help designer with the design procedure.

PCC is advantageous in high-frequency and fast-transient-response dc-dc converters over the other traditional control methods including voltage-mode control and ripple-based control. Peak current mode control shows significantly faster transient response and is much easier to design than the voltage mode control \cite{erikson2007}. Power converter plant in PCC architecture is usually a lower order system compared to voltage mode control because the PCC architecture eliminates the transient from duty cycle to inductor current by measuring and commanding inductor current \cite{Bram2015tpel}. A low order plant makes the compensator design easier and more robust. Peak current mode control is more robust to the output capacitor parasitic and can be applied in any types of dc-dc converters compared to the ripple-based method \cite{Redljian2009tpel}. PCC sense and control the inductor current directly while the ripple-based control has to rely on the assumption that the capacitor voltage contains the information of inductor current. PCC does not rely on the output capacitor and load information, but the ripple-based method can even go in instability if the ESR or ESL is not appropriate. PCC can fix the switching frequency more easily but ripple based control suffers a lot from the jittering in switching frequency. PCC can provide a tight DC voltage regulation. Another important benefit is that PCC naturally does cycle-by-cycle over current protection to the power stage, hence the fault protection design can be simplified. 

Among many PCC architectures in literature, direct PCC using the mixed-signal hardware implementation is one of the most popular approach because it has both fast transient response and programmable flexibility. By whether the inductor current is sensed or not, state-of-the-art PCC can be direct PCC methods and indirect methods. Among direct PCC methods, mixed-signal implementation is the most promising because it shares the benefits of fast transient response and ability to be quickly online tuned to adapt to fast varying operating points. Analog implementation is the most traditional implementation method: The output voltage is processed by an error amplifier and the result is compared with the sensed current signal by an analog comparator \cite{Kaz2006tcs}. Although the design methods are well-established and it is not hard to obtain high control bandwidth, good dynamic performance is not always guaranteed in a wide operating voltage range because {\color{red} electrical dynamics} of circuits change with output voltage operating points and load conditions \cite{erikson2007}. Digital implementation guarantees the programmable flexibility of the adaptive voltage regulation: An analog-to-digital converter (ADC) is added to discretize the sampled inductor current. Then the quantified current is compared with the current command in through digital logic. The implementation of the inductor current sampling can be referred to \cite{Lilee2008APEC}. It is not suitable for high-frequency converter because a high-speed sampler is required. Mixed-signal hardware implementation \cite{Prodic2011tcs} \cite{Huerta2012} combines the advantages of both analog and digital implementations. A common mixed-signal structure includes a digital voltage control loop and an analog current loop.

\begin{figure}
\begin{minipage}{0.32\textwidth}
    \centering
    \includegraphics[width=\textwidth]{Figure/catsatind3.pdf}
    \caption{ \label{catonsatind} Saturating inductance variation during output voltage step transient.}
\end{minipage}
~
\begin{minipage}{0.32\textwidth}
    \centering
    \includegraphics[width=\textwidth]{Figure/ebuckschematicrenew.pdf}
  \caption{  \label{circuitdiagram} Schematic diagram of a digitally-controlled CM-COT buck converter.}
\end{minipage}
~
\begin{minipage}{0.32\textwidth}
    \centering
    \includegraphics[width=\textwidth]{Figure/waveform2.pdf}
    \caption{\label{eboostderivation} Inductor current and capacitor voltage waveforms of a CM-COT buck converter with saturaing inductor.}
\end{minipage}
\end{figure}


Because of the difficulties in measuring inductor current in high-frequency power converters, several indirect PCC are proposed. However, currently proposed Indirect PCC  still cannot outperform the direct PCC.
Current-programmed control constructs the inductor current waveform using the priori-model and control the inductor current indirectly by duty ratio.
The classic current-programmed control \cite{Chendragan2003} is sensitive to the time-varying uncertainties of the inductor model and the input/output voltage measurement. Although \cite{Taeed2014} improves the method by measuring the actual current at two points every cycle and calculate slope, the prediction error is still inevitable because in some applications where the inductor current can go highly non-linear \cite{Ahsanuzzamanprodic2012apec} \cite{DiCapua2016}. Hence curve fitting using 2 sample points can cause significant errors. Another method in \cite{Chattopadhyay2006} claim a control algorithm which is stable under the incorrect current ramp estimation, but the proposed method cannot guarantee fast transient response.
A V\textsuperscript{2}I\textsubscript{c} method by \cite{Huerta2013} measures and control the capacitor current which contains the inductor current information.
However, a complicated impedance matching network has to be designed to compensate the output capacitor parasitic 
\cite{Huerta2009a}. Several derivative output ripple voltage (DORV) techniques get the capacitor current information by differentiating the capacitor voltage \cite{Mai2008} \cite{Chen2017}. Although the methods avoid the complicated capacitor current measurement, it is vulnerable to noises because of derivative calculation. 
Several papers combine the aforementioned current mode control techniques with other control methods, for example, \cite{Huang2002} combines the peak current mode control and the ripple-based control. \cite{Kuang-Yao2013a} is the digital version of  \cite{Huang2002}.